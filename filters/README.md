# Monkeydown

[![www.soimort.org/filters/README.html](http://www.soimort.org/favicon.ico)](http://www.soimort.org/filters/README.html)
***Revision: 0.1*** *(2015-07-12)*

**Monkeydown** (or "Monkey Flavored Markdown") is an extension to the standard / pandoc markdown format, designed in a way that monkeys can easily typeset Shakespeare's works.

The reference implementation **monkey.py** is written in Python 3, implemented as a [pandoc filter](https://github.com/jgm/pandoc/wiki/Pandoc-Filters) that filters ASTs generated by pandoc. Please be warned that there is no formal specification other than the reference implementation; and the implementation is not bugfree. If something works unexpectedly, it is considered to be a feature. (maybe just a misfeature!)

Get a copy of **monkey.py** [here](https://github.com/soimort/soimort.github.io/blob/master/filters/monkey.py) (the source code is released into the public domain).

## Motivation

Markdown is a popular lightweight markup language. It allows you to write in a human-editable plain text format, and later render your text into HTML format. However, there are many things you could do perfectly in HTML which are impossible with pure markdown. To name one, markdown isn't a good fit for typesetting Shakespeare's sonnets:

```
SONNET I

From fairest creatures we desire increase,
That thereby beauty's rose might never die,
But as the riper should by time decease,
His tender heir might bear his memory:
But thou, contracted to thine own bright eyes,
Feed'st thy light'st flame with self-substantial fuel,
Making a famine where abundance lies,
Thyself thy foe, to thy sweet self too cruel.
Thou that art now the world's fresh ornament
And only herald to the gaudy spring, 10
Within thine own bud buriest thy content
And, tender churl, makest waste in niggarding.
  Pity the world, or else this glutton be,
  To eat the world's due, by the grave and thee.
```

Although it's possible to render hard line breaks in markdown, some problems persist. What if the whole sonnet is supposed to be center aligned? What if the sonnet is supposed to be left aligned but placed elegantly in the center of the page, and the two non-breaking spaces preceded each of the last two lines must be kept so that the indentation is clearly seen? You start wrapping your well-written markdown text in ugly HTML tags such as `<div>` and trying to style them. No, no, we could do better than that.

While [separation of presentation and content](https://en.wikipedia.org/wiki/Separation_of_presentation_and_content) is a general rule in web design, it is arguably the case that pure markdown should be considered as "the only content". Markdown is not HTML; there is some content which can be expressed in HTML cannot be expressed in markdown. So, instead of embedding HTML in markdown, why not just make markdown a little richer and let it handle some simple formatting tasks? **Monkeydown** may be breaking the presentation-content-separation rule to some extent, but it can't be any worse than using raw HTML in markdown.

## Extensions

Most formatting rules appear as *commands* in **Monkeydown**. A *command* is usually a string started with a colon "`:`".

### Text Alignment and Positioning

These commands are *block commands*. A *block command* applies to the consecutive paragraph thus must appear in the beginning of that paragraph.

#### `:left` (alternative forms `:l`, `:>`)

Left-align a paragraph.

#### `:right` (alternative forms `:r`, `:<`)

Right-align a paragraph.

#### `:center` (alternative forms `:c`, `:=`)

Center-align a paragraph.

Examples:

```
:r
This text is right-aligned.

:= This text is center-aligned.
```

These commands can also be used to create aligned headings:

```
:c,h1
I am a center-aligned Heading 1

:=## I am a center-aligned Heading 2

:<### I am a right-aligned Heading 3
```

#### `:left=` (alternative forms `:l=`, `:>=`)

Set the `left` CSS property of the paragraph to adjust its position.

#### `:right=` (alternative forms `:r=`, `:<=`)

Set the `right` CSS property of the paragraph to adjust its position.

#### `:width=` (alternative form `:w=`)

Set the `width` CSS property of the paragraph to adjust its width.

Examples:

```
:width=640px
This paragraph has a width of only 640px.

:l=20%,w=60% This paragraph has CSS properties `left: 20%; width: 60%`.
```

There are some shortcut commands for setting CSS `left`/`right` that you may use for convenient indentation:

```
:>-- I'm about 12.5% to the left.

:<---- I'm about 25% to the right.
```

### Line Breaking and Spacing

These commands are *inline commands*. An *inline command* may appear anywhere in a paragraph and takes effect wherever it appears.

#### `:linebreak` (alternative forms `:l`, `:|`)

Insert a hard line break.

#### `:linebreak=` (alternative form `:l=`)

Insert a number of hard line breaks.

#### `:nbsp` (alternative forms `:n`, `:-`)

Insert a non-breaking space.

#### `:nbsp=` (alternative form `:n=`)

Insert a number of non-breaking spaces.

There are some shortcut commands for inserting line breaks and spaces:

```
Look, two line breaks :|| are inside me!

Look, I got three more non-breaking spaces :--- here.
```

### [Bidirectional Text](https://en.wikipedia.org/wiki/Bi-directional_text)

This command is a *block command*. A *block command* applies to the consecutive paragraph thus must appear in the beginning of that paragraph.

#### `:rtl`

Mark the following paragraph as [right-to-left text](https://en.wikipedia.org/wiki/Right-to-left) for rendering correctly to HTML.

Example:

```
:rtl
العربية
```

### Multi-columns

These commands are *block commands*. Furthermore, as they could take effect on multiple paragraphs, they must appear as individual paragraphs themselves.

#### `:columns[PARAMETERS]` (alternative form `:col[PARAMETERS]`)

This is where a multi-column element begins.

#### `:}columns` (alternative forms `:columns`, `:col`)

This is where a multi-column element ends.

Example: (The lorem ipsum text is displayed in 2 columns of height 100px)

```
:col[100px;2]

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint
occaecat cupidatat non proident, sunt in culpa qui officia deserunt
mollit anim id est laborum.

:col
```

### String Formatting

These commands are *inline commands*. Furthermore, as they could take effect on multiple strings, they must appear inside a pair of double tildes "`~~`".

#### `:underline` (alternative forms `:u`, `:_`)

Underline some text.

#### `:color=`

Set the `color` CSS property of some text.

#### `:font=`

Set the `font-family` CSS property of some text.

#### `:font-size=`

Set the `font-size` CSS property of some text.

Examples:

```
~~:_ Look, there's an underline under me~~

~~:color=red I am a red text~~

~~:color=#fff And I am white~~

~~:font=monospace,font-size=2em I am a big monospaced string~~
```

### Image Formatting

These commands are *inline commands*. Furthermore, as they take effect on images, they must appear inside the first brackets when defining images.

#### `:width=` (alternative form `:w=`)

Set the `width` of the image.

Example:

```
![:w=50% Doge](/images/doge.jpg)
```

### Miscellaneous Elements

These commands are *inline commands*. Furthermore, they must appear in the follow-up parentheses of a link.

#### `:kbd`

Generate an HTML `<kbd>` element to identify some keyboard input.

#### `:samp`

Generate an HTML `<samp>` element to identify sample output from a computer program.

#### `:var`

Generate an HTML `<var>` element to represent a variable.

Examples:

```
Switch to next application: [Alt+Tab](:kbd)

[zsh: command not found: ifconfig](:samp)

[x](:var) = [y](:var) + 2
```

### [Ruby Characters](https://en.wikipedia.org/wiki/Ruby_character)

This extension is inspired by [a filter for ruby text](http://pandoc.org/scripting.html#a-filter-for-ruby-text).

Examples:

```
[はん](-飯)

[北](-běi)[京](-jīng)
```

### Metadata Interpolation

This extension is inspired by [pandocfilters/examples/metavars.py](https://github.com/jgm/pandocfilters/blob/master/examples/metavars.py).

Examples:

```
Today is %{date}.

Contact me [via email](%{email})
```

### Checkboxes in Lists

This extension is inspired by [GFM Task Lists](https://github.com/blog/1375%0A-task-lists-in-gfm-issues-pulls-comments).

Example:

```
Project Elephant

- [x] Open the refrigerator
- [x] Take out the giraffe
- [ ] Put in the elephant
- [ ] Close the door
```

## Demo

See a [demo page](http://www.soimort.org/posts/salve-munde) written in **Monkeydown**.
